<ion-header class="mw-header" [class.hide]="isHidden">
  <!-- 游댳 Franja blanca superior -->
  <ion-toolbar class="top">
    <div class="container top-inner">
      <!-- Logo -->
      <a class="brand" routerLink="/home">
        <img src="assets/img/Way.png" alt="Way" />
      </a>

      <!-- Buscador -->
      <div class="search" [class.active]="openSuggest">
        <ion-searchbar
          [value]="query"
          placeholder="Buscar semillas, productos y m치s"
          show-clear-button="focus"
          (ionInput)="onInput($event)"
          (keyup.enter)="submit()"
          (ionClear)="clear()"
          (ionFocus)="openSuggest = true"
          (ionBlur)="hideSuggestDelayed()">
        </ion-searchbar>

        <!-- Panel de sugerencias -->
        <div class="suggest-panel" *ngIf="openSuggest">
          <div class="section" *ngIf="(suggest$ | async)?.recent?.length">
            <div class="title">
              <ion-icon name="time-outline"></ion-icon> B칰squedas recientes
            </div>
            <button class="item" *ngFor="let r of (suggest$ | async)?.recent" (mousedown)="pick(r)">
              {{ r }}
            </button>
          </div>

          <div class="section" *ngIf="(suggest$ | async)?.cats?.length">
            <div class="title">
              <ion-icon name="albums-outline"></ion-icon> Categor칤as
            </div>
            <button class="item" *ngFor="let c of (suggest$ | async)?.cats" (mousedown)="goCat(c.key)">
              {{ c.label }}
            </button>
          </div>

          <div class="section" *ngIf="(suggest$ | async)?.hits?.length">
            <div class="title">
              <ion-icon name="search-outline"></ion-icon> Coincidencias
            </div>
            <button class="item" *ngFor="let h of (suggest$ | async)?.hits" (mousedown)="pick(h)">
              {{ h }}
            </button>
          </div>
        </div>

        <!-- Fondo oscuro cuando las sugerencias est치n abiertas -->
        <div class="overlay" *ngIf="openSuggest" (click)="closeSuggest()"></div>
      </div>

      <!-- Acciones -->
      <div class="actions">
        <ion-button fill="clear" size="small" (click)="openLocation()">
          <ion-icon name="location-outline"></ion-icon>
          <span *ngIf="userLocation">
            {{ userLocation.province || 'Ecuador' }}
          </span>
        </ion-button>

        <ion-button class="login" fill="clear" size="small" (click)="openLogin()">
          <ion-icon name="person-circle-outline"></ion-icon>
          <span *ngIf="!user">Iniciar sesi칩n</span>
          <span *ngIf="user">Hola, {{ user?.profile?.nickname || user?.email }}</span>
        </ion-button>

        <ion-button class="cart-btn" fill="clear" size="small" routerLink="/cart">
          <ion-icon name="cart-outline"></ion-icon>
          <ion-badge *ngIf="cartCount > 0" class="cart-badge">{{ cartCount }}</ion-badge>
        </ion-button>
      </div>
    </div>
  </ion-toolbar>

  <!-- 游댳 Franja azul inferior (categor칤as principales) -->
  <ion-toolbar class="cats">
    <div class="container cat-inner">
      <button class="hamb" type="button" (click)="openMenu()">
        <ion-icon name="menu-outline"></ion-icon>
        <span>Todo</span>
      </button>

      <nav class="cat-nav">
        <a routerLink="/home" routerLinkActive="active" [routerLinkActiveOptions]="{exact:true}">Home</a>
        <a routerLink="/semillas" routerLinkActive="active">Semillas</a>
        <a routerLink="/insecticidas" routerLinkActive="active">Insecticidas</a>
        <a routerLink="/herbicidas" routerLinkActive="active">Herbicidas</a>
        <a routerLink="/fungicidas" routerLinkActive="active">Fungicidas</a>
        <a routerLink="/acaricidas" routerLinkActive="active">Acaricidas</a>
        <a routerLink="/nutricion" routerLinkActive="active">Nutrici칩n Foliar</a>
        <a routerLink="/maquinaria" routerLinkActive="active">Maquinaria y accesorios</a>
      </nav>
    </div>
  </ion-toolbar>
</ion-header>
